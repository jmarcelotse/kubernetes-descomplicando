# Diagramas de Deployment no Kubernetes

Este documento contÃ©m diagramas visuais para entender melhor como funcionam os Deployments no Kubernetes.

## ğŸ—ï¸ Arquitetura HierÃ¡rquica

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DEPLOYMENT                               â”‚
â”‚                         (nginx-deployment)                         â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      REPLICASET                             â”‚   â”‚
â”‚  â”‚                 (nginx-deployment-abc123)                  â”‚   â”‚
â”‚  â”‚                                                             â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚    POD 1    â”‚  â”‚    POD 2    â”‚  â”‚    POD 3    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ Running     â”‚  â”‚ Running     â”‚  â”‚ Running     â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Processo de Rolling Update

### Estado Inicial (v1)
```
Deployment: nginx-deployment (replicas: 3)
ReplicaSet: nginx-deployment-v1 (desired: 3, current: 3)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Passo 1: Novo ReplicaSet Criado
```
kubectl set image deployment/nginx-deployment nginx=nginx:1.21

Deployment: nginx-deployment (replicas: 3)
ReplicaSet v1: nginx-deployment-v1 (desired: 3, current: 3)
ReplicaSet v2: nginx-deployment-v2 (desired: 0, current: 0) â† Novo

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Passo 2: Primeiro Pod v2 Criado
```
ReplicaSet v1: nginx-deployment-v1 (desired: 3, current: 3)
ReplicaSet v2: nginx-deployment-v2 (desired: 1, current: 1)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚  Starting   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Passo 3: Pod v2 Ready, Pod v1 Terminando
```
ReplicaSet v1: nginx-deployment-v1 (desired: 2, current: 2)
ReplicaSet v2: nginx-deployment-v2 (desired: 1, current: 1)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚ Terminating â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Passo 4: ContinuaÃ§Ã£o do Rolling Update
```
ReplicaSet v1: nginx-deployment-v1 (desired: 1, current: 1)
ReplicaSet v2: nginx-deployment-v2 (desired: 2, current: 2)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Estado Final (v2)
```
ReplicaSet v1: nginx-deployment-v1 (desired: 0, current: 0)
ReplicaSet v2: nginx-deployment-v2 (desired: 3, current: 3)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”™ Processo de Rollback

### Estado Atual (v2 com problema)
```
kubectl rollout undo deployment/nginx-deployment

ReplicaSet v1: nginx-deployment-v1 (desired: 0, current: 0)
ReplicaSet v2: nginx-deployment-v2 (desired: 3, current: 3)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚  CrashLoop  â”‚  â”‚  CrashLoop  â”‚  â”‚  CrashLoop  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Rollback em Progresso
```
ReplicaSet v1: nginx-deployment-v1 (desired: 1, current: 1) â† Reativado
ReplicaSet v2: nginx-deployment-v2 (desired: 2, current: 2)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚  Starting   â”‚  â”‚  CrashLoop  â”‚  â”‚ Terminating â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Rollback Completo
```
ReplicaSet v1: nginx-deployment-v1 (desired: 3, current: 3)
ReplicaSet v2: nginx-deployment-v2 (desired: 0, current: 0)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚  â”‚   Pod v1    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚  â”‚ nginx:1.20  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ Escalonamento de Deployment

### Estado Inicial (3 rÃ©plicas)
```
kubectl scale deployment nginx-deployment --replicas=5

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Pod 1    â”‚  â”‚    Pod 2    â”‚  â”‚    Pod 3    â”‚
â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Escalonamento para 5 rÃ©plicas
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Pod 1    â”‚  â”‚    Pod 2    â”‚  â”‚    Pod 3    â”‚  â”‚    Pod 4    â”‚  â”‚    Pod 5    â”‚
â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚  Starting   â”‚  â”‚  Starting   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ EstratÃ©gias de Deployment

### Rolling Update Strategy
```yaml
strategy:
  type: RollingUpdate
  rollingUpdate:
    maxUnavailable: 1    # MÃ¡ximo 1 pod indisponÃ­vel
    maxSurge: 1          # MÃ¡ximo 1 pod extra
```

```
CenÃ¡rio: 3 rÃ©plicas, maxUnavailable=1, maxSurge=1

Estado Normal:     [Pod1] [Pod2] [Pod3]
Durante Update:    [Pod1] [Pod2] [Pod4] â† Pod3 terminando, Pod4 iniciando
PrÃ³ximo Passo:     [Pod1] [Pod4] [Pod5] â† Pod2 terminando, Pod5 iniciando
Estado Final:      [Pod4] [Pod5] [Pod6] â† Todos os pods atualizados
```

### Recreate Strategy
```yaml
strategy:
  type: Recreate
```

```
Estado Inicial:    [Pod1] [Pod2] [Pod3]
Terminando Todos:  [ --- ] [ --- ] [ --- ] â† Downtime
Criando Novos:     [Pod4] [Pod5] [Pod6] â† Nova versÃ£o
```

## ğŸ¯ Deployment com Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SERVICE                            â”‚
â”‚                     (nginx-service)                        â”‚
â”‚                    ClusterIP: 10.96.1.100                  â”‚
â”‚                         Port: 80                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ Load Balancing
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DEPLOYMENT                           â”‚
â”‚                    (nginx-deployment)                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚    Pod 1    â”‚  â”‚    Pod 2    â”‚  â”‚    Pod 3    â”‚        â”‚
â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚        â”‚
â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Ready     â”‚        â”‚
â”‚  â”‚ IP: 10.1.1.1â”‚  â”‚ IP: 10.1.1.2â”‚  â”‚ IP: 10.1.1.3â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Monitoramento Visual

### Status do Deployment
```bash
kubectl get deployments
```
```
NAME               READY   UP-TO-DATE   AVAILABLE   AGE
nginx-deployment   3/3     3            3           5m
```

### VisualizaÃ§Ã£o dos ReplicaSets
```bash
kubectl get rs
```
```
NAME                         DESIRED   CURRENT   READY   AGE
nginx-deployment-abc123      3         3         3       5m
nginx-deployment-def456      0         0         0       2m
```

### Timeline de Rollout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ROLLOUT TIMELINE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ T0: Deployment Created                                      â”‚
â”‚     â””â”€â”€ ReplicaSet-v1 (3 pods)                            â”‚
â”‚                                                             â”‚
â”‚ T1: Image Updated (nginx:1.20 â†’ nginx:1.21)               â”‚
â”‚     â”œâ”€â”€ ReplicaSet-v2 created                             â”‚
â”‚     â””â”€â”€ Rolling update started                             â”‚
â”‚                                                             â”‚
â”‚ T2: Rolling Update Complete                                 â”‚
â”‚     â”œâ”€â”€ ReplicaSet-v1 (0 pods)                            â”‚
â”‚     â””â”€â”€ ReplicaSet-v2 (3 pods)                            â”‚
â”‚                                                             â”‚
â”‚ T3: Rollback Initiated                                      â”‚
â”‚     â””â”€â”€ ReplicaSet-v1 reactivated                         â”‚
â”‚                                                             â”‚
â”‚ T4: Rollback Complete                                       â”‚
â”‚     â”œâ”€â”€ ReplicaSet-v1 (3 pods)                            â”‚
â”‚     â””â”€â”€ ReplicaSet-v2 (0 pods)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš¨ CenÃ¡rios de Falha

### Pod Failure Durante Update
```
Estado Durante Update:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚   Failed    â”‚ â† Falha
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Kubernetes Action:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pod v1    â”‚  â”‚   Pod v2    â”‚  â”‚   Pod v2    â”‚
â”‚ nginx:1.20  â”‚  â”‚ nginx:1.21  â”‚  â”‚ nginx:1.21  â”‚
â”‚   Ready     â”‚  â”‚   Ready     â”‚  â”‚  Starting   â”‚ â† Novo pod
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Node Failure
```
Antes da Falha:
Node1: [Pod1] [Pod2]
Node2: [Pod3]
Node3: [ --- ]

ApÃ³s Falha do Node2:
Node1: [Pod1] [Pod2]
Node2: [ FAILED ]
Node3: [Pod3-new] â† Kubernetes recria o pod
```

## ğŸ“Š Health Check Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      POD LIFECYCLE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Pod Created â†’ Container Starting â†’ Readiness Probe        â”‚
â”‚       â”‚              â”‚                    â”‚                â”‚
â”‚       â–¼              â–¼                    â–¼                â”‚
â”‚  Pending â”€â”€â”€â”€â”€â”€â–º Running â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Ready â”€â”€â”€â”€â”€â”€â–º Service â”‚
â”‚                     â”‚                    â”‚         Traffic â”‚
â”‚                     â–¼                    â”‚                â”‚
â”‚              Liveness Probe              â”‚                â”‚
â”‚                     â”‚                    â”‚                â”‚
â”‚                 Failed? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                     â”‚                                      â”‚
â”‚                     â–¼                                      â”‚
â”‚              Container Restart                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Estes diagramas ajudam a visualizar como os Deployments funcionam na prÃ¡tica, desde a criaÃ§Ã£o atÃ© o gerenciamento de atualizaÃ§Ãµes e falhas.
