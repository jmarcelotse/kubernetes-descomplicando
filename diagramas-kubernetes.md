# Diagramas Kubernetes - Visão Geral

Este arquivo contém diagramas complementares para melhor compreensão dos conceitos de Kubernetes e containerização.

## 1. Evolução da Infraestrutura

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    EVOLUÇÃO DA INFRAESTRUTURA                          │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────────────┐  │
│  │  BARE METAL     │  │ VIRTUAL MACHINES│  │      CONTAINERS         │  │
│  │                 │  │                 │  │                         │  │
│  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────────────┐ │  │
│  │ │    App A    │ │  │ │    App A    │ │  │ │ App A │ App B │ App C │ │  │
│  │ └─────────────┘ │  │ └─────────────┘ │  │ └─────────────────────┘ │  │
│  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────────────┐ │  │
│  │ │     OS      │ │  │ │   Guest OS  │ │  │ │    Container Engine │ │  │
│  │ └─────────────┘ │  │ └─────────────┘ │  │ └─────────────────────┘ │  │
│  │ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────────────┐ │  │
│  │ │  Hardware   │ │  │ │ Hypervisor  │ │  │ │      Host OS        │ │  │
│  │ └─────────────┘ │  │ └─────────────┘ │  │ └─────────────────────┘ │  │
│  │                 │  │ ┌─────────────┐ │  │ ┌─────────────────────┐ │  │
│  │                 │  │ │  Hardware   │ │  │ │      Hardware       │ │  │
│  │                 │  │ └─────────────┘ │  │ └─────────────────────┘ │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────────────┘  │
│                                                                         │
│     • Uma app por                • Isolamento via VM           • Múltiplas apps    │
│       servidor                   • Overhead de recursos        • Compartilha kernel │
│     • Subutilização              • Melhor utilização           • Máxima eficiência │
│     • Difícil escalar            • Portabilidade limitada      • Portabilidade total│
└─────────────────────────────────────────────────────────────────────────┘
```

## 2. Ciclo de Vida de um Pod

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        CICLO DE VIDA DO POD                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌───────────┐ │
│  │   PENDING   │───▶│   RUNNING   │───▶│ SUCCEEDED   │    │ COMPLETED │ │
│  │             │    │             │    │             │    │           │ │
│  │ • Scheduling│    │ • Container │    │ • All       │    │ • Job     │ │
│  │ • Image Pull│    │   Running   │    │   containers│    │   finished│ │
│  │ • Volume    │    │ • Health    │    │   exited    │    │ • Success │ │
│  │   Mount     │    │   Checks    │    │   success   │    │   status  │ │
│  └─────────────┘    └─────────────┘    └─────────────┘    └───────────┘ │
│         │                   │                                           │
│         │                   ▼                                           │
│         │            ┌─────────────┐                                    │
│         │            │   FAILED    │                                    │
│         │            │             │                                    │
│         │            │ • Container │                                    │
│         │            │   crashed   │                                    │
│         │            │ • Health    │                                    │
│         │            │   check fail│                                    │
│         │            └─────────────┘                                    │
│         │                                                               │
│         ▼                                                               │
│  ┌─────────────┐                                                        │
│  │   UNKNOWN   │                                                        │
│  │             │                                                        │
│  │ • Node      │                                                        │
│  │   unreachable│                                                       │
│  │ • Network   │                                                        │
│  │   issues    │                                                        │
│  └─────────────┘                                                        │
└─────────────────────────────────────────────────────────────────────────┘
```
## 3. Networking no Kubernetes

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      KUBERNETES NETWORKING                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                        CLUSTER NETWORK                             ││
│  │                                                                     ││
│  │  ┌─────────────────┐              ┌─────────────────────────────────┐││
│  │  │   Worker Node 1 │              │         Worker Node 2           │││
│  │  │                 │              │                                 │││
│  │  │ ┌─────────────┐ │              │ ┌─────────────┐ ┌─────────────┐│││
│  │  │ │    Pod A    │ │              │ │    Pod C    │ │    Pod D    ││││
│  │  │ │ 10.244.1.10 │ │              │ │ 10.244.2.10 │ │ 10.244.2.11 ││││
│  │  │ └─────────────┘ │              │ └─────────────┘ └─────────────┘│││
│  │  │ ┌─────────────┐ │              │                                 │││
│  │  │ │    Pod B    │ │              │ ┌─────────────────────────────┐│││
│  │  │ │ 10.244.1.11 │ │              │ │         Service             ││││
│  │  │ └─────────────┘ │              │ │      (ClusterIP)            ││││
│  │  │                 │              │ │      10.96.0.100            ││││
│  │  │ ┌─────────────┐ │              │ └─────────────────────────────┘│││
│  │  │ │ kube-proxy  │ │              │ ┌─────────────┐                │││
│  │  │ │(iptables)   │ │              │ │ kube-proxy  │                │││
│  │  │ └─────────────┘ │              │ │(iptables)   │                │││
│  │  └─────────────────┘              │ └─────────────┘                │││
│  │                                   └─────────────────────────────────┘││
│  └─────────────────────────────────────────────────────────────────────┘│
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                      EXTERNAL ACCESS                               ││
│  │                                                                     ││
│  │  Internet ──▶ LoadBalancer ──▶ NodePort ──▶ ClusterIP ──▶ Pods     ││
│  │                                                                     ││
│  └─────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────┘
```

## 4. Storage no Kubernetes

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      KUBERNETES STORAGE                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                    STORAGE HIERARCHY                               ││
│  │                                                                     ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐ ││
│  │  │    Pod      │    │    PVC      │    │         PV              │ ││
│  │  │             │    │             │    │                         │ ││
│  │  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────────────────┐ │ ││
│  │  │ │ Volume  │ │───▶│ │ Claim   │ │───▶│ │   Physical Storage  │ │ ││
│  │  │ │ Mount   │ │    │ │ Request │ │    │ │                     │ │ ││
│  │  │ └─────────┘ │    │ └─────────┘ │    │ │ • AWS EBS           │ │ ││
│  │  └─────────────┘    └─────────────┘    │ │ • GCE PD            │ │ ││
│  │                                        │ │ • Azure Disk        │ │ ││
│  │                                        │ │ • NFS               │ │ ││
│  │                                        │ └─────────────────────┘ │ ││
│  │                                        └─────────────────────────┘ ││
│  └─────────────────────────────────────────────────────────────────────┘│
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                    STORAGE CLASSES                                 ││
│  │                                                                     ││
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────────┐ ││
│  │  │    Fast     │  │   Standard  │  │          Slow               │ ││
│  │  │             │  │             │  │                             │ ││
│  │  │ • SSD       │  │ • HDD       │  │ • Archive                   │ ││
│  │  │ • High IOPS │  │ • Balanced  │  │ • Cold Storage              │ ││
│  │  │ • Expensive │  │ • Cost      │  │ • Cheap                     │ ││
│  │  └─────────────┘  └─────────────┘  └─────────────────────────────┘ ││
│  └─────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────┘
```
## 5. Deployment e Scaling

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    DEPLOYMENT STRATEGIES                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                    ROLLING UPDATE                                  ││
│  │                                                                     ││
│  │  Step 1: ┌───┐ ┌───┐ ┌───┐                                         ││
│  │          │v1 │ │v1 │ │v1 │  ◄── Current Version                    ││
│  │          └───┘ └───┘ └───┘                                         ││
│  │                                                                     ││
│  │  Step 2: ┌───┐ ┌───┐ ┌───┐                                         ││
│  │          │v1 │ │v1 │ │v2 │  ◄── Start Replacing                    ││
│  │          └───┘ └───┘ └───┘                                         ││
│  │                                                                     ││
│  │  Step 3: ┌───┐ ┌───┐ ┌───┐                                         ││
│  │          │v1 │ │v2 │ │v2 │  ◄── Continue Replacing                 ││
│  │          └───┘ └───┘ └───┘                                         ││
│  │                                                                     ││
│  │  Step 4: ┌───┐ ┌───┐ ┌───┐                                         ││
│  │          │v2 │ │v2 │ │v2 │  ◄── Complete                           ││
│  │          └───┘ └───┘ └───┘                                         ││
│  └─────────────────────────────────────────────────────────────────────┘│
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                    BLUE-GREEN DEPLOYMENT                           ││
│  │                                                                     ││
│  │  Blue:   ┌───┐ ┌───┐ ┌───┐     Green: ┌───┐ ┌───┐ ┌───┐           ││
│  │          │v1 │ │v1 │ │v1 │             │v2 │ │v2 │ │v2 │           ││
│  │          └───┘ └───┘ └───┘             └───┘ └───┘ └───┘           ││
│  │             ▲                                                       ││
│  │             │                                                       ││
│  │        ┌─────────┐                                                  ││
│  │        │ Traffic │  ──────────────────────────────▶                ││
│  │        └─────────┘                                                  ││
│  │                                                                     ││
│  │  Switch Traffic:                                                    ││
│  │        ┌─────────┐                                                  ││
│  │        │ Traffic │  ──────────────────────────────▶                ││
│  │        └─────────┘                             ▲                   ││
│  │                                                │                   ││
│  │          ┌───┐ ┌───┐ ┌───┐             ┌───┐ ┌───┐ ┌───┐           ││
│  │          │v1 │ │v1 │ │v1 │             │v2 │ │v2 │ │v2 │           ││
│  │          └───┘ └───┘ └───┘             └───┘ └───┘ └───┘           ││
│  └─────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────┘
```

## 6. Monitoramento e Observabilidade

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    OBSERVABILITY STACK                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                        METRICS                                     ││
│  │                                                                     ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐ ││
│  │  │ Prometheus  │───▶│   Grafana   │───▶│      Alertmanager       │ ││
│  │  │             │    │             │    │                         │ ││
│  │  │ • Scraping  │    │ • Dashboards│    │ • Notifications         │ ││
│  │  │ • Storage   │    │ • Queries   │    │ • Routing               │ ││
│  │  │ • Alerting  │    │ • Alerts    │    │ • Grouping              │ ││
│  │  └─────────────┘    └─────────────┘    └─────────────────────────┘ ││
│  └─────────────────────────────────────────────────────────────────────┘│
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                         LOGS                                       ││
│  │                                                                     ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐ ││
│  │  │  Fluentd    │───▶│Elasticsearch│───▶│        Kibana           │ ││
│  │  │             │    │             │    │                         │ ││
│  │  │ • Collection│    │ • Indexing  │    │ • Visualization         │ ││
│  │  │ • Parsing   │    │ • Search    │    │ • Analysis              │ ││
│  │  │ • Routing   │    │ • Storage   │    │ • Dashboards            │ ││
│  │  └─────────────┘    └─────────────┘    └─────────────────────────┘ ││
│  └─────────────────────────────────────────────────────────────────────┘│
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────────┐│
│  │                       TRACING                                      ││
│  │                                                                     ││
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐ ││
│  │  │   Jaeger    │───▶│   Storage   │───▶│         UI              │ ││
│  │  │             │    │             │    │                         │ ││
│  │  │ • Tracing   │    │ • Cassandra │    │ • Trace View            │ ││
│  │  │ • Spans     │    │ • Elasticsearch│ │ • Service Map           │ ││
│  │  │ • Context   │    │ • Memory    │    │ • Performance           │ ││
│  │  └─────────────┘    └─────────────┘    └─────────────────────────┘ ││
│  └─────────────────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────────────┘
```
